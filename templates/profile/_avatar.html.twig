{# Avatar component with initials fallback #}
{% set initials = '' %}
{% if user.firstName and user.lastName %}
    {% set initials = user.firstName|slice(0, 1)|upper ~ user.lastName|slice(0, 1)|upper %}
{% elseif user.username %}
    {% set initials = user.username|slice(0, 2)|upper %}
{% else %}
    {% set initials = 'U' %}
{% endif %}

{% set avatarSize = size|default('lg') %}
{% set sizeClasses = {
    'sm': 'w-10 h-10 text-sm',
    'md': 'w-16 h-16 text-xl',
    'lg': 'w-24 h-24 text-3xl',
    'xl': 'w-32 h-32 text-4xl'
} %}

<div class="relative inline-block">
    {% if user.avatar %}
        <img src="{{ asset('uploads/profiles/' ~ user.id ~ '/' ~ user.avatar) }}"
             alt="{{ user.username }}"
             class="rounded-full {{ sizeClasses[avatarSize] }} object-cover border-4 border-white shadow-lg">
    {% else %}
        <div class="rounded-full {{ sizeClasses[avatarSize] }} bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center text-white font-bold border-4 border-white shadow-lg">
            {{ initials }}
        </div>
    {% endif %}

    {% if showOnline|default(false) %}
        <span class="absolute bottom-1 right-1 block h-4 w-4 rounded-full bg-green-500 border-2 border-white"></span>
    {% endif %}
</div>
